# 🔎 Vulnerability Analysis Notes

## 🔹 Nmap Scripting Engine (NSE)  
Nmap has a scripting engine that allows **automation of advanced scans**.  
Scripts are written in **Lua** and are divided into categories:  

- **auth** → Tests authentication (default/weak credentials, login bypass).  
  ```bash
  nmap --script auth <target_ip> -sS
  ```
  📌 Example: Can detect weak SSH/FTP logins.

- **malware** → Detects backdoors, trojans, worms, and known malware signatures.  
  ```bash
  nmap --script malware <target_ip> -sS
  ```
  📌 Example: Checks if system is infected with Conficker worm.

- **banner** → Grabs service banners (like version info).  
  ```bash
  nmap --script banner <target_ip> -sS
  ```
  📌 Example: Can leak version numbers → used later for vuln lookup.

- **exploit** → Tries to exploit known vulnerabilities.  
  ```bash
  nmap --script exploit <target_ip> -sS
  ```
  ⚠️ Use only in authorized environments (penetration testing / lab).

---

## 🔹 Other Useful NSE Categories
- **vuln** → Checks for known vulnerabilities (CVE detection).  
  ```bash
  nmap --script vuln <target_ip>
  ```
- **safe** → Non-intrusive, doesn’t harm target.  
- **intrusive** → Aggressive, may crash services.  

---

## 🔹 SearchSploit (Exploit Database)  
SearchSploit is part of **Exploit-DB** and helps you find exploits for detected versions.  

- Update local database:  
  ```bash
  searchsploit -u
  ```
- Search by keyword:  
  ```bash
  searchsploit apache 2.4.49
  searchsploit openssl
  ```
- Show exploit file path:  
  ```bash
  searchsploit -p apache 2.4.49
  ```

---

## 🔹 Recommended Workflow for Vulnerability Analysis
1. **Run Nmap scan** → `nmap -sS -sV <target_ip>`  
   - Detect open ports + versions.  
2. **Use NSE scripts** → `nmap --script vuln,auth,malware,banner <target_ip>`  
   - Identify weak creds, malware, and vulnerabilities.  
3. **Cross-check with SearchSploit** → find public exploits.  
4. **Verify manually** → sometimes banner/version can be false.  
5. **Document findings** → CVE ID, exploit path, risk level.

---

✅ Example Attack Chain:  
- Nmap finds **OpenSSH 7.2** running.  
- `banner` + `auth` NSE confirm version & weak login allowed.  
- SearchSploit shows **OpenSSH 7.2 vulnerability (CVE-2016-6210)**.  
- Exploit found, validated in controlled environment.  
